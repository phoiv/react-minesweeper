[{"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\index.js":"1","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\App.js":"2","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\reportWebVitals.js":"3","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\containers\\Minesweeper\\Minesweeper.js":"4","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\GameBoard\\GameBoard.js":"5","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\GameHeader\\GameHeader.js":"6","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\Settings\\Settings.js":"7","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\GameBoard\\Square\\Square.js":"8"},{"size":510,"mtime":1609163046062,"results":"9","hashOfConfig":"10"},{"size":451,"mtime":1616957478497,"results":"11","hashOfConfig":"10"},{"size":362,"mtime":499162500000,"results":"12","hashOfConfig":"10"},{"size":10240,"mtime":1616957490927,"results":"13","hashOfConfig":"10"},{"size":1019,"mtime":1616957510091,"results":"14","hashOfConfig":"10"},{"size":361,"mtime":1616957571055,"results":"15","hashOfConfig":"10"},{"size":2460,"mtime":1616957487538,"results":"16","hashOfConfig":"10"},{"size":2910,"mtime":1616957500404,"results":"17","hashOfConfig":"10"},{"filePath":"18","messages":"19","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},"lfjdw8",{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},{"filePath":"23","messages":"24","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},{"filePath":"25","messages":"26","errorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"27","usedDeprecatedRules":"20"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"32","messages":"33","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\index.js",[],["36","37"],"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\App.js",[],"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\reportWebVitals.js",[],"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\containers\\Minesweeper\\Minesweeper.js",["38","39","40","41","42","43","44","45","46","47","48","49"],"import classes from './Minesweeper.module.css';\r\nimport GameHeader from '../../components/GameHeader/GameHeader.js'\r\nimport GameBoard from '../../components/GameBoard/GameBoard.js'\r\nimport Settings from '../../components/Settings/Settings.js'\r\nimport { useEffect, useState, useRef } from 'react';\r\n\r\n// const conf = {\r\n//     beginner: [9, 9, 10],\r\n//     intermediate: [16, 16, 40],\r\n//     expert: [16, 30, 99],\r\n//     custom: [null, null, null],\r\n// }\r\nconst conf = {\r\n    'beginner': { width: 9, height: 9, mines: 10 },\r\n    'intermediate': { width: 16, height: 16, mines: 40 },\r\n    'expert': { width: 16, height: 30, mines: 99 },\r\n    'custom': [null, null, null],\r\n}\r\n\r\n\r\nfunction Minesweeper() {\r\n    const [gameConfig, setConf] = useState({\r\n        width: 12,\r\n        height: 10,\r\n        mines: 10\r\n    });\r\n    const [board, setBoard] = useState(() => generateBoard(gameConfig.width, gameConfig.height, gameConfig.mines))\r\n    const [gameState, setGameState] = useState(\"ready\") //lost/won/ready/playing\r\n    const [opened, setOpened] = useState(0)\r\n    const [flagged, setFlagged] = useState(0)\r\n    const [timer, setTimer] = useState(0)\r\n    const [settingsOpen, setSettingsOpen] = useState(false);\r\n\r\n    const minesweeperBoard = useRef(null);\r\n    //the goal of the game is to open all non bombs squares\r\n    const target = gameConfig.width * gameConfig.height - gameConfig.mines;\r\n    console.log('target===', target)\r\n\r\n    //we want to catch right click on the board and disable it\r\n    useEffect(() => {\r\n        minesweeperBoard.current.addEventListener(\"contextmenu\", (evt) => flagHandler(evt, null))\r\n\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (gameState === \"running\") {\r\n            let id = setInterval(function () {\r\n                setTimer(timer => timer + 1)\r\n            }\r\n                , 1000);\r\n            return () => clearInterval(id)\r\n        }\r\n    }, [gameState])\r\n\r\n    useEffect(() => {\r\n        if (opened === target)\r\n            gameWon()\r\n    }, [opened])\r\n\r\n    // useEffect(() => {\r\n    //     console.log(\"hihi\")\r\n    //     const newBoard = generateBoard(gameConfig.width, gameConfig.height, gameConfig.mines);\r\n    //     setBoard(newBoard)\r\n\r\n    // }, [gameConfig])\r\n\r\n    const flagHandler = (evt, tilePos) => {\r\n        evt.preventDefault();\r\n        console.log(\"RIGHT CLICKED\", tilePos)\r\n        //do nothing for rc on board\r\n        if (!tilePos && tilePos != 0) return;\r\n        if (board[tilePos].isOpen) return;\r\n        if (gameState === 'won' || gameState === 'lost') return;\r\n        if (board[tilePos].isFlagged) setFlagged(flagged => flagged - 1)\r\n        if (!board[tilePos].isFlagged) setFlagged(flagged => flagged + 1)\r\n\r\n        const newBoard = [...board];\r\n        newBoard[tilePos].isFlagged = !newBoard[tilePos].isFlagged;\r\n        setBoard(newBoard)\r\n    }\r\n\r\n    const revealTileHandler = (tilePos) => {\r\n        if (board[tilePos].isFlagged) return;\r\n        if (board[tilePos].content === -1) {\r\n            gameLost(tilePos);\r\n            return;\r\n        }\r\n\r\n        if (gameState === \"ready\") setGameState(\"running\")\r\n        if (gameState === 'won' || gameState === 'lost') return;\r\n\r\n        const newBoard = [...board];\r\n        newBoard[tilePos].isOpen = true;\r\n        setBoard(newBoard)\r\n        setOpened((opened) => opened + 1)\r\n        if (newBoard[tilePos].content === 0)\r\n            newBoard[tilePos].neighbours.forEach(tile => {\r\n                if (!newBoard[tile].isOpen)\r\n                    revealTileHandler(tile)\r\n            })\r\n\r\n        //check win condition\r\n\r\n    }\r\n\r\n    function gameLost(boom) {\r\n\r\n        //we use content -10 and -2 for extra styling options\r\n        //-2 is thew bomb we opened and lost the game\r\n        //-10 are the squares we had flagged as bombs but were safe\r\n        const newBoard = [...board];\r\n        newBoard.forEach(tile => {\r\n            if (tile.content === -1 && !tile.isFlagged)\r\n                tile.isOpen = true;\r\n            //flagged non-bomb\r\n            if (tile.isFlagged && tile.content !== -1) {\r\n                tile.isOpen = true;\r\n                tile.isFlagged = false;\r\n                tile.content = -10;\r\n            }\r\n        })\r\n        newBoard[boom].content = -2\r\n        setBoard(newBoard)\r\n        setGameState(\"lost\")\r\n    }\r\n\r\n    function gameWon() {\r\n        const newBoard = [...board];\r\n        newBoard.forEach(tile => {\r\n            if (tile.content === -1)\r\n                tile.isFlagged = true;\r\n        })\r\n        setBoard(newBoard)\r\n        setGameState(\"won\")\r\n    }\r\n\r\n    let clicks = 0\r\n    function handleClick() {\r\n        if (settingsOpen) return\r\n        clicks++\r\n        if (clicks == 2) {\r\n            clicks = 0\r\n            openSettings()\r\n        }\r\n        setTimeout(function () {\r\n            if (clicks == 1) {\r\n                restart()\r\n                clicks = 0\r\n            }\r\n        }, 150);\r\n    }\r\n\r\n    const restart = () => {\r\n        const newBoard = generateBoard(gameConfig.width, gameConfig.height, gameConfig.mines);\r\n        setBoard(newBoard)\r\n        setGameState('ready')\r\n        setOpened(0);\r\n        setFlagged(0);\r\n        setTimer(0)\r\n    }\r\n    const openSettings = () => {\r\n        console.log(\"open settings\")\r\n        setSettingsOpen(!settingsOpen)\r\n    }\r\n\r\n    const closeSettings = () => {\r\n        console.log(\"closing..\")\r\n        setSettingsOpen(!settingsOpen)\r\n    }\r\n    // const onChangeValue = (evt) => {\r\n    //     console.log(evt.target.value)\r\n    // }\r\n\r\n    const settingsChanged = (evt) => {\r\n        evt.preventDefault();\r\n        const setting = evt.target.elements.setting.value;\r\n        if (setting === \"\") {\r\n            setSettingsOpen(false);\r\n            return;\r\n        }\r\n        console.log('changing settings ==>', setting)\r\n\r\n\r\n        let newConf = {}\r\n        if (setting == 'custom') {\r\n\r\n            newConf.width = parseInt(evt.target.elements.cW.value);\r\n            if (newConf.width != newConf.width || newConf.width < 5) newConf.width = 5;\r\n            newConf.width = Math.min(30, newConf.width);\r\n            // if (newConf.width > 30) newConf.width = 30\r\n\r\n            newConf.height = parseInt(evt.target.elements.cH.value);\r\n            if (newConf.height != newConf.height || newConf.height < 5) newConf.height = 5;\r\n            newConf.height = Math.min(30, newConf.height);\r\n            // if (newConf.height > 30) newConf.height = 30\r\n\r\n            newConf.mines = parseInt(evt.target.elements.cM.value);\r\n            if (newConf.mines != newConf.mines || newConf.mines < 5) newConf.mines = 5;\r\n            if (newConf.mines > newConf.height * newConf.width) newConf.mines = newConf.height * newConf.width - 1\r\n\r\n        }\r\n        else {\r\n            newConf = { ...conf[setting] }\r\n        }\r\n\r\n        setSettingsOpen(false);\r\n\r\n        console.log(newConf)\r\n        const newBoard = generateBoard(newConf.width, newConf.height, newConf.mines);\r\n        setBoard(newBoard)\r\n        setConf(newConf)\r\n        setGameState('ready')\r\n        setOpened(0);\r\n        setFlagged(0);\r\n        setTimer(0)\r\n    }\r\n\r\n    let status\r\n    if (gameState === 'lost') status = \"GAME OVER\"\r\n    else if (gameState === 'ready') status = \"LETS PLAY\"\r\n    else if (gameState === 'running') status = \"PLAYING\"\r\n    else if (gameState === 'won') status = \"YOU WIN\"\r\n\r\n    return (\r\n        <div className={classes.minesweeperWrapper}>\r\n\r\n            <div className={classes.minesweeper}\r\n                ref={minesweeperBoard}>\r\n\r\n                <GameHeader clicked={handleClick} time={timer} minesLeft={gameConfig.mines - flagged}>\r\n                    {status}\r\n                </GameHeader>\r\n\r\n                <GameBoard\r\n                    width={gameConfig.width}\r\n                    height={gameConfig.height}\r\n                    board={board}\r\n                    gameOver={gameState === \"won\" || gameState === \"lost\"}\r\n                    clicked={revealTileHandler}\r\n                    right_clicked={flagHandler}\r\n                />\r\n            </div>\r\n            { settingsOpen ? <Settings submitted={settingsChanged} clicked={closeSettings} /> : null}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Minesweeper;\r\n\r\n\r\n\r\n//content: can be -1 for bomb or a number >= 0 showing neighbouring bombs\r\n//neighbours: an array with neighbouring squares (3-8)\r\n//isOpen: has the player revealed this square?\r\n//isFlagged ??? has the player flagged it (right click)\r\nclass Tile {\r\n    constructor(content) {\r\n        this.content = content;\r\n        this.isOpen = false;\r\n        this.isFlagged = false;\r\n        this.neighbours = [];\r\n    }\r\n}\r\n\r\n\r\nfunction generateBoard(width, height, mines) {\r\n    console.log(`MAKING BOARD ${width}x${height} with ${mines} mines`)\r\n    const max = width * height;\r\n    const board = new Array(max).fill(null)\r\n\r\n    for (let i = 0; i < max; i++) {\r\n        const newSquare = new Tile(0);\r\n        board[i] = newSquare;\r\n        const newNeighbours = [];\r\n        //find neighbours\r\n        //top-left\r\n        if (i >= width && i % width !== 0) newNeighbours.push(i - width - 1)\r\n        //top\r\n        if (i >= width) newNeighbours.push(i - width)\r\n        //top-right\r\n        if (i >= width && i % width !== width - 1) newNeighbours.push(i - width + 1)\r\n        //right\r\n        if (i % width !== width - 1) newNeighbours.push(i + 1)\r\n        //bottom-right\r\n        if (i < max - width && i % width !== width - 1) newNeighbours.push(i + width + 1)\r\n        //bottom\r\n        if (i < max - width) newNeighbours.push(i + width)\r\n        //bottom-left\r\n        if (i < max - width && i % width !== 0) newNeighbours.push(i + width - 1)\r\n        //left\r\n        if (i % width !== 0) newNeighbours.push(i - 1)\r\n\r\n        newSquare.neighbours = newNeighbours;\r\n    }\r\n\r\n    //set up mines\r\n    let i = 1;\r\n\r\n    while (i <= mines) {\r\n        let pos = Math.floor(Math.random() * max);\r\n        //if theres a bomb there continue and get a new pos\r\n        if (board[pos].content === -1) continue;\r\n        //set new bomb\r\n        board[pos].content = -1;\r\n        board[pos].neighbours.forEach(tile => {\r\n\r\n            if (board[tile].content !== -1) board[tile].content++\r\n        })\r\n        i++\r\n    }\r\n    return board\r\n}","C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\GameBoard\\GameBoard.js",[],"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\GameHeader\\GameHeader.js",[],"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\Settings\\Settings.js",[],"C:\\Users\\phoeb\\OneDrive\\Desktop\\WD2\\REACT\\minesweeper\\src\\components\\GameBoard\\Square\\Square.js",[],{"ruleId":"50","replacedBy":"51"},{"ruleId":"52","replacedBy":"53"},{"ruleId":"54","severity":1,"message":"55","line":43,"column":8,"nodeType":"56","endLine":43,"endColumn":10,"suggestions":"57"},{"ruleId":"54","severity":1,"message":"58","line":58,"column":8,"nodeType":"56","endLine":58,"endColumn":16,"suggestions":"59"},{"ruleId":"60","severity":1,"message":"61","line":71,"column":33,"nodeType":"62","messageId":"63","endLine":71,"endColumn":35},{"ruleId":"60","severity":1,"message":"64","line":141,"column":20,"nodeType":"62","messageId":"63","endLine":141,"endColumn":22},{"ruleId":"60","severity":1,"message":"64","line":146,"column":24,"nodeType":"62","messageId":"63","endLine":146,"endColumn":26},{"ruleId":"60","severity":1,"message":"64","line":185,"column":21,"nodeType":"62","messageId":"63","endLine":185,"endColumn":23},{"ruleId":"65","severity":1,"message":"66","line":188,"column":17,"nodeType":"62","messageId":"67","endLine":188,"endColumn":47},{"ruleId":"60","severity":1,"message":"61","line":188,"column":31,"nodeType":"62","messageId":"63","endLine":188,"endColumn":33},{"ruleId":"65","severity":1,"message":"66","line":193,"column":17,"nodeType":"62","messageId":"67","endLine":193,"endColumn":49},{"ruleId":"60","severity":1,"message":"61","line":193,"column":32,"nodeType":"62","messageId":"63","endLine":193,"endColumn":34},{"ruleId":"65","severity":1,"message":"66","line":198,"column":17,"nodeType":"62","messageId":"67","endLine":198,"endColumn":47},{"ruleId":"60","severity":1,"message":"61","line":198,"column":31,"nodeType":"62","messageId":"63","endLine":198,"endColumn":33},"no-native-reassign",["68"],"no-negated-in-lhs",["69"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'flagHandler'. Either include it or remove the dependency array.","ArrayExpression",["70"],"React Hook useEffect has missing dependencies: 'gameWon' and 'target'. Either include them or remove the dependency array.",["71"],"eqeqeq","Expected '!==' and instead saw '!='.","BinaryExpression","unexpected","Expected '===' and instead saw '=='.","no-self-compare","Comparing to itself is potentially pointless.","comparingToSelf","no-global-assign","no-unsafe-negation",{"desc":"72","fix":"73"},{"desc":"74","fix":"75"},"Update the dependencies array to be: [flagHandler]",{"range":"76","text":"77"},"Update the dependencies array to be: [gameWon, opened, target]",{"range":"78","text":"79"},[1635,1637],"[flagHandler]",[2003,2011],"[gameWon, opened, target]"]